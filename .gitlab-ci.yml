variables:
  # PostgreSQL Configuration
  POSTGRES_USER: vaulthelpers
  POSTGRES_PASSWORD: supersecretpassword

  # Vault Configuration
  VAULT_DEV_LISTEN_ADDRESS: 0.0.0.0:8200
  VAULT_DEV_ROOT_TOKEN_ID: my-root-token

  # Test Configuration
  VAULT_TOKEN: my-root-token
  VAULT_URL: http://vault:8200/
  VAULT_CACERT:
  VAULT_SKIP_VERIFY: 'yes'
  VAULT_DEBUG: 'no'
  VAULT_DATABASE_PATH: database/creds/vaulthelpers-sandbox
  VAULT_AWS_PATH: aws/sts/vaulthelpers-sandbox
  DATABASE_URL: postgres://postgres:5432/vaulthelpers
  DATABASE_OWNERROLE: vaulthelpers

stages:
  - test

services:
  - postgres:9.6
  - vault:latest

cache:
  key: "$CI_PROJECT_NAME"
  paths:
    - $HOME/.cache/pip

before_script:
  - pip install tox

test_python34:
  stage: test
  image: python:3.4
  script: tox --skip-missing-interpreters

test_python35:
  stage: test
  image: python:3.5
  script: tox --skip-missing-interpreters

test_python36:
  stage: test
  image: python:3.6
  script: tox --skip-missing-interpreters
